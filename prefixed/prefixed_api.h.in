// alloc8 - Prefixed allocation API
// Generated header for prefix: @ALLOC8_PREFIX@
//
// This file was generated by CMake. Do not edit manually.

#ifndef ALLOC8_@ALLOC8_PREFIX_UPPER@_MALLOC_H
#define ALLOC8_@ALLOC8_PREFIX_UPPER@_MALLOC_H

#include <stddef.h>

#ifdef __cplusplus
extern "C" {
#endif

// ─── CORE ALLOCATION FUNCTIONS ────────────────────────────────────────────────

/**
 * Allocate memory.
 * @param size Number of bytes to allocate
 * @return Pointer to allocated memory, or NULL on failure
 */
void* @ALLOC8_PREFIX@_malloc(size_t size);

/**
 * Free memory.
 * @param ptr Pointer to memory to free (NULL is safe)
 */
void @ALLOC8_PREFIX@_free(void* ptr);

/**
 * Reallocate memory.
 * @param ptr Pointer to existing allocation (NULL = malloc)
 * @param size New size (0 = free on POSIX, small alloc on macOS)
 * @return Pointer to reallocated memory, or NULL on failure
 */
void* @ALLOC8_PREFIX@_realloc(void* ptr, size_t size);

/**
 * Allocate zeroed memory.
 * @param count Number of elements
 * @param size Size of each element
 * @return Pointer to zeroed memory, or NULL on failure/overflow
 */
void* @ALLOC8_PREFIX@_calloc(size_t count, size_t size);

// ─── ALIGNED ALLOCATION ───────────────────────────────────────────────────────

/**
 * Allocate aligned memory.
 * @param alignment Required alignment (must be power of 2)
 * @param size Number of bytes to allocate
 * @return Aligned pointer, or NULL on failure
 */
void* @ALLOC8_PREFIX@_memalign(size_t alignment, size_t size);

/**
 * POSIX aligned allocation.
 * @param memptr Output pointer location
 * @param alignment Required alignment (power of 2, >= sizeof(void*))
 * @param size Number of bytes to allocate
 * @return 0 on success, EINVAL or ENOMEM on failure
 */
int @ALLOC8_PREFIX@_posix_memalign(void** memptr, size_t alignment, size_t size);

/**
 * C11 aligned allocation.
 * @param alignment Required alignment
 * @param size Size (must be multiple of alignment)
 * @return Aligned pointer, or NULL on failure
 */
void* @ALLOC8_PREFIX@_aligned_alloc(size_t alignment, size_t size);

/**
 * Page-aligned allocation.
 * @param size Number of bytes to allocate
 * @return Page-aligned pointer, or NULL on failure
 */
void* @ALLOC8_PREFIX@_valloc(size_t size);

/**
 * Page-aligned allocation with size rounded to page.
 * @param size Number of bytes (rounded up to page boundary)
 * @return Page-aligned pointer, or NULL on failure
 */
void* @ALLOC8_PREFIX@_pvalloc(size_t size);

// ─── SIZE QUERY ───────────────────────────────────────────────────────────────

/**
 * Get usable size of allocation.
 * @param ptr Pointer to allocated memory
 * @return Usable size in bytes, or 0 for NULL/invalid
 */
size_t @ALLOC8_PREFIX@_malloc_usable_size(void* ptr);

// ─── STRING FUNCTIONS ─────────────────────────────────────────────────────────

/**
 * Duplicate string.
 * @param s String to duplicate (NULL returns NULL)
 * @return New allocated string, or NULL on failure
 */
char* @ALLOC8_PREFIX@_strdup(const char* s);

/**
 * Duplicate string with maximum length.
 * @param s String to duplicate (NULL returns NULL)
 * @param n Maximum characters to copy
 * @return New allocated string, or NULL on failure
 */
char* @ALLOC8_PREFIX@_strndup(const char* s, size_t n);

// ─── LOCK/UNLOCK (FORK SAFETY) ────────────────────────────────────────────────

/**
 * Lock allocator (call before fork).
 */
void @ALLOC8_PREFIX@_malloc_lock(void);

/**
 * Unlock allocator (call after fork in parent/child).
 */
void @ALLOC8_PREFIX@_malloc_unlock(void);

// ─── EXTENSIONS ───────────────────────────────────────────────────────────────

/**
 * Reallocate array with overflow protection.
 * @param ptr Pointer to existing allocation
 * @param nmemb Number of elements
 * @param size Size of each element
 * @return Reallocated pointer, or NULL on failure/overflow
 */
void* @ALLOC8_PREFIX@_reallocarray(void* ptr, size_t nmemb, size_t size);

#ifdef __cplusplus
}
#endif

#endif // ALLOC8_@ALLOC8_PREFIX_UPPER@_MALLOC_H
